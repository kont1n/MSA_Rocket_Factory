name: Combined Reports

on:
  workflow_call:
    inputs:
      modules:
        required: true
        type: string
      go-version:
        required: true
        type: string
      golangci-lint-version:
        required: true
        type: string

jobs:
  combined-reports:
    name: Generate combined reports
    runs-on: ubuntu-latest
    timeout-minutes: 15

    permissions:
      contents: write
      pages: write
      id-token: write

    steps:
      - name: üì¶ Checkout code
        uses: actions/checkout@v4.2.2

      - name: üõ†Ô∏è Set up Go
        uses: actions/setup-go@v5.4.0
        with:
          go-version: ${{ inputs.go-version }}

      - name: üóÑÔ∏è Cache Go modules
        uses: actions/cache@v4.2.0
        with:
          path: |
            ~/.cache/go-build
            ~/go/pkg/mod
          key: ${{ runner.os }}-v1-go-${{ hashFiles('**/go.sum', 'go.work.sum') }}
          restore-keys: |
            ${{ runner.os }}-v1-go-

      - name: üîÑ Install dependencies
        run: |
          go work sync
          find . -name "go.mod" -type f | while read -r modfile; do
            dir=$(dirname "$modfile")
            echo "Processing module in: $dir"
            cd "$dir"
            go mod tidy
            cd - > /dev/null
          done

      - name: üìå Install Task
        uses: arduino/setup-task@v2.0.0

      - name: üìå Install gocov-html
        run: |
          go install github.com/axw/gocov/gocov@v1
          go install github.com/matm/gocov-html/cmd/gocov-html@v1

      - name: üîç Run Lint
        id: lint_step
        env:
          MODULES: ${{ inputs.modules }}
          GOLANGCI_LINT_VERSION: ${{ inputs.golangci-lint-version }}
        run: |
          echo "üîç –ó–∞–ø—É—Å–∫ golangci-lint..."
          mkdir -p .github_pages/lint
          
          # –ó–∞–ø—É—Å–∫–∞–µ–º –ª–∏–Ω—Ç —á–µ—Ä–µ–∑ Task –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          set +e  # –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ
          task lint > lint_output.txt 2>&1
          lint_exit_code=$?
          set -e  # –í–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
          
          if [ $lint_exit_code -eq 0 ]; then
            echo "‚úÖ –õ–∏–Ω—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ"
            echo "LINT_STATUS=success" >> $GITHUB_OUTPUT
            lint_result="success"
          else
            echo "‚ùå –ù–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞"
            echo "LINT_STATUS=failure" >> $GITHUB_OUTPUT 
            lint_result="failure"
          fi
          
          # –°–æ–∑–¥–∞–µ–º HTML –æ—Ç—á–µ—Ç –ª–∏–Ω—Ç–∏–Ω–≥–∞
          cat > .github_pages/lint/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>üîç Lint Report</title>
              <style>
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
                      line-height: 1.6;
                      color: #24292f;
                      max-width: 1200px;
                      margin: 0 auto;
                      padding: 20px;
                      background: #ffffff;
                  }
                  .header {
                      text-align: center;
                      padding: 20px 0;
                      border-bottom: 2px solid #e1e4e8;
                      margin-bottom: 30px;
                  }
                  .status-success {
                      background: #dcfce7;
                      color: #15803d;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bbf7d0;
                  }
                  .status-failure {
                      background: #fef2f2;
                      color: #dc2626;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #fecaca;
                  }
                  .report-content {
                      background: #f6f8fa;
                      padding: 20px;
                      border-radius: 8px;
                      border: 1px solid #d1d9e0;
                      font-family: 'SF Mono', Consolas, monospace;
                      white-space: pre-wrap;
                      font-size: 14px;
                      overflow-x: auto;
                  }
                  .info {
                      background: #f0f9ff;
                      color: #0369a1;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bae6fd;
                      margin: 20px 0;
                  }
                  .navigation {
                      text-align: center;
                      margin: 30px 0;
                  }
                  .nav-link {
                      display: inline-block;
                      margin: 0 10px;
                      padding: 8px 16px;
                      background: #f6f8fa;
                      color: #24292f;
                      text-decoration: none;
                      border-radius: 6px;
                      border: 1px solid #d1d9e0;
                  }
                  .nav-link:hover {
                      background: #e1e4e8;
                  }
              </style>
          </head>
          <body>
              <div class="header">
                  <h1>üîç Lint Report</h1>
          EOF
          
          if [ "$lint_result" = "success" ]; then
              echo '        <div class="status-success">‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ - –æ—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>' >> .github_pages/lint/index.html
          else
              echo '        <div class="status-failure">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞</div>' >> .github_pages/lint/index.html
          fi
          
          cat >> .github_pages/lint/index.html << 'EOF'
              </div>
              
              <div class="navigation">
                  <a href="../" class="nav-link">üìä Coverage Report</a>
                  <a href="../tests/" class="nav-link">üß™ Unit Tests</a>
                  <a href="../integration/" class="nav-link">üîó Integration Tests</a>
                  <a href="./" class="nav-link">üîç Lint Report</a>
                  <a href="../reports.html" class="nav-link">üìã All Reports</a>
              </div>
              
              <div class="info">
                  <strong>–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω:</strong> 
          EOF
          
          echo "$(date)" >> .github_pages/lint/index.html
          echo '<br><strong>Commit:</strong> ${{ github.sha }}' >> .github_pages/lint/index.html
          echo '<br><strong>Branch:</strong> ${{ github.ref_name }}' >> .github_pages/lint/index.html
          
          cat >> .github_pages/lint/index.html << 'EOF'
              </div>
              
              <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–∏–Ω—Ç–∏–Ω–≥–∞:</h2>
              <div class="report-content">
          EOF
          
          if [ -f lint_output.txt ]; then
              sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g' lint_output.txt >> .github_pages/lint/index.html
          else
              echo "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–∏–Ω—Ç–∏–Ω–≥–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã" >> .github_pages/lint/index.html
          fi
          
          cat >> .github_pages/lint/index.html << 'EOF'
              </div>
          </body>
          </html>
          EOF

      - name: üß™ Run Tests
        id: test_step
        env:
          MODULES: ${{ inputs.modules }}
        run: |
          echo "üß™ –ó–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤..."
          mkdir -p .github_pages/tests
          
          # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Task –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          set +e  # –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ
          task test > test_output.txt 2>&1
          test_exit_code=$?
          set -e  # –í–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
          
          if [ $test_exit_code -eq 0 ]; then
            echo "‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ"
            echo "TEST_STATUS=success" >> $GITHUB_OUTPUT
            test_result="success"
          else
            echo "‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö"
            echo "TEST_STATUS=failure" >> $GITHUB_OUTPUT
            test_result="failure"
          fi
          
          # –°–æ–∑–¥–∞–µ–º HTML –æ—Ç—á–µ—Ç —Ç–µ—Å—Ç–æ–≤
          cat > .github_pages/tests/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>üß™ Test Report</title>
              <style>
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
                      line-height: 1.6;
                      color: #24292f;
                      max-width: 1200px;
                      margin: 0 auto;
                      padding: 20px;
                      background: #ffffff;
                  }
                  .header {
                      text-align: center;
                      padding: 20px 0;
                      border-bottom: 2px solid #e1e4e8;
                      margin-bottom: 30px;
                  }
                  .status-success {
                      background: #dcfce7;
                      color: #15803d;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bbf7d0;
                  }
                  .status-failure {
                      background: #fef2f2;
                      color: #dc2626;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #fecaca;
                  }
                  .report-content {
                      background: #f6f8fa;
                      padding: 20px;
                      border-radius: 8px;
                      border: 1px solid #d1d9e0;
                      font-family: 'SF Mono', Consolas, monospace;
                      white-space: pre-wrap;
                      font-size: 14px;
                      overflow-x: auto;
                  }
                  .info {
                      background: #f0f9ff;
                      color: #0369a1;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bae6fd;
                      margin: 20px 0;
                  }
                  .navigation {
                      text-align: center;
                      margin: 30px 0;
                  }
                  .nav-link {
                      display: inline-block;
                      margin: 0 10px;
                      padding: 8px 16px;
                      background: #f6f8fa;
                      color: #24292f;
                      text-decoration: none;
                      border-radius: 6px;
                      border: 1px solid #d1d9e0;
                  }
                  .nav-link:hover {
                      background: #e1e4e8;
                  }
              </style>
          </head>
          <body>
              <div class="header">
                  <h1>üß™ Test Report</h1>
          EOF
          
          if [ "$test_result" = "success" ]; then
              echo '        <div class="status-success">‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ</div>' >> .github_pages/tests/index.html
          else
              echo '        <div class="status-failure">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö</div>' >> .github_pages/tests/index.html
          fi
          
          cat >> .github_pages/tests/index.html << 'EOF'
              </div>
              
              <div class="navigation">
                  <a href="../" class="nav-link">üìä Coverage Report</a>
                  <a href="./" class="nav-link">üß™ Unit Tests</a>
                  <a href="../integration/" class="nav-link">üîó Integration Tests</a>
                  <a href="../lint/" class="nav-link">üîç Lint Report</a>
                  <a href="../reports.html" class="nav-link">üìã All Reports</a>
              </div>
              
              <div class="info">
                  <strong>–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω:</strong> 
          EOF
          
          echo "$(date)" >> .github_pages/tests/index.html
          echo '<br><strong>Commit:</strong> ${{ github.sha }}' >> .github_pages/tests/index.html
          echo '<br><strong>Branch:</strong> ${{ github.ref_name }}' >> .github_pages/tests/index.html
          
          # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç–µ—Å—Ç–æ–≤ –∏–∑ –≤—ã–≤–æ–¥–∞
          test_summary=""
          if [ -f test_output.txt ]; then
            passed_count=$(grep -o "PASS.*" test_output.txt | wc -l | tr -d ' ')
            failed_count=$(grep -o "FAIL.*" test_output.txt | wc -l | tr -d ' ')
            
            if [ "$passed_count" -gt 0 ] || [ "$failed_count" -gt 0 ]; then
              test_summary="<br><strong>–ü—Ä–æ–π–¥–µ–Ω–æ:</strong> $passed_count <strong>–ü—Ä–æ–≤–∞–ª–µ–Ω–æ:</strong> $failed_count"
            fi
          fi
          
          cat >> .github_pages/tests/index.html << EOF
              $test_summary
              </div>
              
              <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h2>
              <div class="report-content">
          EOF
          
          if [ -f test_output.txt ]; then
              sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g' test_output.txt >> .github_pages/tests/index.html
          else
              echo "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã" >> .github_pages/tests/index.html
          fi
          
          cat >> .github_pages/tests/index.html << 'EOF'
              </div>
          </body>
          </html>
          EOF

      - name: üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è .env —Ñ–∞–π–ª–æ–≤
        env:
          SERVICES: "inventory,order,payment"
        run: |
          # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ .env —Ñ–∞–π–ª—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
          echo "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è .env —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤..."
          task env:generate

          # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          echo "‚úÖ –§–∞–π–ª—ã .env –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ —Å–æ–∑–¥–∞–Ω—ã"

      - name: üê≥ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: üß© Set up Docker cache
        uses: actions/cache@v4
        with:
          path: /tmp/.buildx-cache
          key: ${{ runner.os }}-buildx-${{ github.sha }}
          restore-keys: |
            ${{ runner.os }}-buildx-

      - name: üìä Run Integration Tests
        id: integration_test_step
        env:
          MODULES: ${{ inputs.modules }}
        run: |
          echo "üß™ –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º..."
          echo "üìã –ú–æ–¥—É–ª–∏: ${{ inputs.modules }}"
          echo "üïí –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞: $(date '+%Y-%m-%d %H:%M:%S UTC')"
          echo "üñ•Ô∏è Runner: ${{ runner.os }}"
          mkdir -p .github_pages/integration
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
          echo ""
          echo "üîß –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:"
          echo "- Go –≤–µ—Ä—Å–∏—è: $(go version 2>/dev/null || echo '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω')"
          echo "- Docker –≤–µ—Ä—Å–∏—è: $(docker --version 2>/dev/null || echo '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω')"
          echo "- –î–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å: $(free -h | grep Mem | awk '{print $7}' 2>/dev/null || echo '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')"
          echo "- –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ: $(df -h / | tail -1 | awk '{print $4}' 2>/dev/null || echo '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')"
          echo ""
          
          # –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Task –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          echo "‚ñ∂Ô∏è –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É: task test-integration"
          echo "========================================"
          set +e  # –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ
          
          # –ó–∞–ø—É—Å–∫–∞–µ–º —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª
          task test-integration 2>&1 | tee integration_output.txt
          integration_exit_code=${PIPESTATUS[0]}
          set -e  # –í–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
          
          echo "========================================"
          echo "üèÅ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤"
          echo "üìä –ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: $integration_exit_code"
          echo "üïí –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: $(date '+%Y-%m-%d %H:%M:%S UTC')"
          
          # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
          if [ -f "integration_output.txt" ]; then
            total_tests=$(grep -c "=== RUN" integration_output.txt 2>/dev/null || echo "0")
            passed_tests=$(grep -c "PASS:" integration_output.txt 2>/dev/null || echo "0")
            failed_tests=$(grep -c "FAIL:" integration_output.txt 2>/dev/null || echo "0")
            
            echo ""
            echo "üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:"
            echo "- –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤ –∑–∞–ø—É—â–µ–Ω–æ: $total_tests"
            echo "- –ü—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ: $passed_tests"
            echo "- –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: $failed_tests"
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–≤–∞–ª–∏–≤—à–∏—Ö—Å—è —Ç–µ—Å—Ç–æ–≤
            if [ $failed_tests -gt 0 ]; then
              echo ""
              echo "‚ùå –î–ï–¢–ê–õ–ò –ü–†–û–í–ê–õ–ò–í–®–ò–•–°–Ø –¢–ï–°–¢–û–í:"
              grep -A 10 -B 2 "FAIL:" integration_output.txt || echo "–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
            fi
          else
            echo "‚ö†Ô∏è –§–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω"
          fi
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
          echo ""
          echo "üê≥ –°–û–°–¢–û–Ø–ù–ò–ï DOCKER –ö–û–ù–¢–ï–ô–ù–ï–†–û–í:"
          docker ps -a 2>/dev/null || echo "Docker –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
          
          if [ $integration_exit_code -eq 0 ]; then
            echo ""
            echo "‚úÖ –í–°–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ï –¢–ï–°–¢–´ –ü–†–û–®–õ–ò –£–°–ü–ï–®–ù–û!"
            echo "INTEGRATION_STATUS=success" >> $GITHUB_OUTPUT
            integration_result="success"
          else
            echo ""
            echo "üí• –û–ë–ù–ê–†–£–ñ–ï–ù–´ –û–®–ò–ë–ö–ò –í –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–• –¢–ï–°–¢–ê–•!"
            echo "üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤—ã–≤–µ–¥–µ–Ω–∞ –≤—ã—à–µ"
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
            echo ""
            echo "üîç –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê:"
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–≥–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
            if command -v docker >/dev/null 2>&1; then
              echo "üìã –õ–æ–≥–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫):"
              for container in $(docker ps -aq 2>/dev/null || echo ""); do
                if [ ! -z "$container" ]; then
                  container_name=$(docker inspect --format='{{.Name}}' $container 2>/dev/null | sed 's/\///' || echo "unknown")
                  echo "--- $container_name ($container) ---"
                  docker logs --tail=20 $container 2>&1 || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏"
                  echo ""
                fi
              done
            fi
            
            echo "INTEGRATION_STATUS=failure" >> $GITHUB_OUTPUT
            integration_result="failure"
          fi
          
          # –°–æ–∑–¥–∞–µ–º HTML –æ—Ç—á–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
          cat > .github_pages/integration/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>üîó Integration Test Report</title>
              <style>
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
                      line-height: 1.6;
                      color: #24292f;
                      max-width: 1200px;
                      margin: 0 auto;
                      padding: 20px;
                      background: #ffffff;
                  }
                  .header {
                      text-align: center;
                      padding: 20px 0;
                      border-bottom: 2px solid #e1e4e8;
                      margin-bottom: 30px;
                  }
                  .status-success {
                      background: #dcfce7;
                      color: #15803d;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bbf7d0;
                  }
                  .status-failure {
                      background: #fef2f2;
                      color: #dc2626;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #fecaca;
                  }
                  .report-content {
                      background: #f6f8fa;
                      padding: 20px;
                      border-radius: 8px;
                      border: 1px solid #d1d9e0;
                      font-family: 'SF Mono', Consolas, monospace;
                      white-space: pre-wrap;
                      font-size: 14px;
                      overflow-x: auto;
                  }
                  .info {
                      background: #f0f9ff;
                      color: #0369a1;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bae6fd;
                      margin: 20px 0;
                  }
                  .navigation {
                      text-align: center;
                      margin: 30px 0;
                  }
                  .nav-link {
                      display: inline-block;
                      margin: 0 10px;
                      padding: 8px 16px;
                      background: #f6f8fa;
                      color: #24292f;
                      text-decoration: none;
                      border-radius: 6px;
                      border: 1px solid #d1d9e0;
                  }
                  .nav-link:hover {
                      background: #e1e4e8;
                  }
              </style>
          </head>
          <body>
              <div class="header">
                  <h1>üîó Integration Test Report</h1>
          EOF
          
          if [ "$integration_result" = "success" ]; then
              echo '        <div class="status-success">‚úÖ –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ</div>' >> .github_pages/integration/index.html
          else
              echo '        <div class="status-failure">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö</div>' >> .github_pages/integration/index.html
          fi
          
          cat >> .github_pages/integration/index.html << 'EOF'
              </div>
              
              <div class="navigation">
                  <a href="../" class="nav-link">üìä Coverage Report</a>
                  <a href="../tests/" class="nav-link">üß™ Unit Tests</a>
                  <a href="./" class="nav-link">üîó Integration Tests</a>
                  <a href="../lint/" class="nav-link">üîç Lint Report</a>
                  <a href="../reports.html" class="nav-link">üìã All Reports</a>
              </div>
              
              <div class="info">
                  <strong>–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω:</strong> 
          EOF
          
          echo "$(date)" >> .github_pages/integration/index.html
          echo '<br><strong>Commit:</strong> ${{ github.sha }}' >> .github_pages/integration/index.html
          echo '<br><strong>Branch:</strong> ${{ github.ref_name }}' >> .github_pages/integration/index.html
          
          # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç–µ—Å—Ç–æ–≤ –∏–∑ –≤—ã–≤–æ–¥–∞
          integration_summary=""
          if [ -f integration_output.txt ]; then
            passed_count=$(grep -o "PASS.*" integration_output.txt | wc -l | tr -d ' ')
            failed_count=$(grep -o "FAIL.*" integration_output.txt | wc -l | tr -d ' ')
            
            if [ "$passed_count" -gt 0 ] || [ "$failed_count" -gt 0 ]; then
              integration_summary="<br><strong>–ü—Ä–æ–π–¥–µ–Ω–æ:</strong> $passed_count <strong>–ü—Ä–æ–≤–∞–ª–µ–Ω–æ:</strong> $failed_count"
            fi
          fi
          
          cat >> .github_pages/integration/index.html << EOF
              $integration_summary
              </div>
              
              <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h2>
              <div class="report-content">
          EOF
          
          if [ -f integration_output.txt ]; then
              sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g' integration_output.txt >> .github_pages/integration/index.html
          else
              echo "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã" >> .github_pages/integration/index.html
          fi
          
          cat >> .github_pages/integration/index.html << 'EOF'
              </div>
          </body>
          </html>
          EOF

      - name: üßπ Cleanup Docker containers
        if: always()
        run: |
          echo "üßπ Cleaning up dangling containers..."
          docker container prune -f

      - name: üìä Run Coverage
        run: |
          echo "üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏..."
          mkdir -p .github_pages
          
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é Task –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫—Ä—ã—Ç–∏—è
          if task test-coverage > coverage_output.txt 2>&1; then
            echo "‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ"
            
            # –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø–æ–∫—Ä—ã—Ç–∏—è –∏–∑ coverage/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            if [ -f "coverage/coverage.out" ] && [ -s "coverage/coverage.out" ]; then
              cp coverage/coverage.out coverage.out
              
              # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
              if go tool cover -func=coverage.out > cover.out 2>&1; then
                echo "‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω"
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
                echo "üìà –ò—Ç–æ–≥–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:"
                tail -1 cover.out
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –æ—Ç—á–µ—Ç
                echo "üåê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –æ—Ç—á–µ—Ç–∞..."
                if gocov convert coverage.out | gocov-html > .github_pages/index.html 2>&1; then
                  echo "‚úÖ HTML –æ—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω"
                  
                  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∫ HTML –æ—Ç—á–µ—Ç—É –ø–æ–∫—Ä—ã—Ç–∏—è
                  sed -i '/<\/head>/i\
                  <style>\
                  .navigation {\
                    position: fixed;\
                    top: 10px;\
                    right: 10px;\
                    background: white;\
                    padding: 10px;\
                    border: 1px solid #ccc;\
                    border-radius: 5px;\
                    box-shadow: 0 2px 5px rgba(0,0,0,0.2);\
                    z-index: 1000;\
                  }\
                  .nav-link {\
                    display: inline-block;\
                    margin: 0 5px;\
                    padding: 5px 10px;\
                    background: #f6f8fa;\
                    color: #24292f;\
                    text-decoration: none;\
                    border-radius: 3px;\
                    border: 1px solid #d1d9e0;\
                    font-size: 12px;\
                  }\
                  .nav-link:hover {\
                    background: #e1e4e8;\
                  }\
                  </style>' .github_pages/index.html
                  
                  sed -i '/<body>/a\
                  <div class="navigation">\
                    <a href="./" class="nav-link">üìä Coverage</a>\
                    <a href="./tests/" class="nav-link">üß™ Unit Tests</a>\
                    <a href="./integration/" class="nav-link">üîó Integration Tests</a>\
                    <a href="./lint/" class="nav-link">üîç Lint</a>\
                    <a href="./reports.html" class="nav-link">üìã All Reports</a>\
                  </div>' .github_pages/index.html
                else
                  echo "‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è HTML –æ—Ç—á–µ—Ç–∞"
                  echo "<html><body><h1>Failed to generate coverage report</h1><p>Check logs for details</p></body></html>" > .github_pages/index.html
                fi
              else
                echo "‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞"
                cat cover.out
                echo "total:                  (statements)   0.0%" > cover.out
                echo "<html><body><h1>Failed to generate coverage report</h1><p>Error generating function report</p></body></html>" > .github_pages/index.html
              fi
            else
              echo "‚ö†Ô∏è –§–∞–π–ª –ø–æ–∫—Ä—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç–æ–π"
              echo "total:                  (statements)   0.0%" > cover.out
              echo "<html><body><h1>No coverage data available</h1><p>No coverage file generated</p></body></html>" > .github_pages/index.html
            fi
          else
            echo "‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫—Ä—ã—Ç–∏—è"
            cat coverage_output.txt
            echo "total:                  (statements)   0.0%" > cover.out
            echo "<html><body><h1>Coverage generation failed</h1><p>Check logs for details</p></body></html>" > .github_pages/index.html
          fi
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
          echo "üîç –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:"
          echo "coverage.out —Ä–∞–∑–º–µ—Ä: $(ls -la coverage.out 2>/dev/null || echo '–Ω–µ –Ω–∞–π–¥–µ–Ω')"
          echo "cover.out —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:"
          cat cover.out 2>/dev/null || echo "cover.out –Ω–µ –Ω–∞–π–¥–µ–Ω"

      - name: üîó Create main reports index
        run: |
          # –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –º–µ–∂–¥—É –æ—Ç—á–µ—Ç–∞–º–∏
          cat > .github_pages/reports.html << 'EOF'
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>üìä Reports Dashboard</title>
              <style>
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
                      line-height: 1.6;
                      color: #24292f;
                      max-width: 1200px;
                      margin: 0 auto;
                      padding: 20px;
                      background: #ffffff;
                  }
                  .header {
                      text-align: center;
                      padding: 20px 0;
                      border-bottom: 2px solid #e1e4e8;
                      margin-bottom: 30px;
                  }
                  .reports-grid {
                      display: grid;
                      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                      gap: 20px;
                      margin: 30px 0;
                  }
                  .report-card {
                      background: #f6f8fa;
                      border: 1px solid #d1d9e0;
                      border-radius: 8px;
                      padding: 20px;
                      text-align: center;
                      transition: box-shadow 0.2s;
                  }
                  .report-card:hover {
                      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                  }
                  .report-link {
                      display: block;
                      color: #0969da;
                      text-decoration: none;
                      font-weight: 600;
                      font-size: 18px;
                      margin: 10px 0;
                  }
                  .report-link:hover {
                      text-decoration: underline;
                  }
                  .report-desc {
                      color: #656d76;
                      font-size: 14px;
                  }
                  .info {
                      background: #f0f9ff;
                      color: #0369a1;
                      padding: 12px 20px;
                      border-radius: 8px;
                      border: 1px solid #bae6fd;
                      margin: 20px 0;
                      text-align: center;
                  }
                  .status-overview {
                      display: grid;
                      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                      gap: 15px;
                      margin: 20px 0;
                  }
                  .status-item {
                      padding: 10px;
                      border-radius: 6px;
                      text-align: center;
                      font-weight: 600;
                  }
                  .status-success { background: #dcfce7; color: #15803d; }
                  .status-failure { background: #fef2f2; color: #dc2626; }
              </style>
          </head>
          <body>
              <div class="header">
                  <h1>üìä MSA Rocket Factory - Reports Dashboard</h1>
              </div>
              
              <div class="info">
                  <strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> $(date)<br>
                  <strong>Commit:</strong> ${{ github.sha }}<br>
                  <strong>Branch:</strong> ${{ github.ref_name }}
              </div>
              
              <div class="status-overview">
                  <div class="status-item $([[ "${{ steps.lint_step.outputs.LINT_STATUS }}" == "success" ]] && echo "status-success" || echo "status-failure")">
                      üîç Lint: ${{ steps.lint_step.outputs.LINT_STATUS }}
                  </div>
                  <div class="status-item $([[ "${{ steps.test_step.outputs.TEST_STATUS }}" == "success" ]] && echo "status-success" || echo "status-failure")">
                      üß™ Unit Tests: ${{ steps.test_step.outputs.TEST_STATUS }}
                  </div>
                  <div class="status-item $([[ "${{ steps.integration_test_step.outputs.INTEGRATION_STATUS }}" == "success" ]] && echo "status-success" || echo "status-failure")">
                      üîó Integration Tests: ${{ steps.integration_test_step.outputs.INTEGRATION_STATUS }}
                  </div>
                  <div class="status-item status-success">
                      üìä Coverage: Generated
                  </div>
              </div>
              
              <div class="reports-grid">
                  <div class="report-card">
                      <h2>üìä</h2>
                      <a href="./" class="report-link">Coverage Report</a>
                      <p class="report-desc">–û—Ç—á–µ—Ç –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ —Ñ–∞–π–ª–∞–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º</p>
                  </div>
                  
                  <div class="report-card">
                      <h2>üß™</h2>
                      <a href="./tests/" class="report-link">Unit Test Report</a>
                      <p class="report-desc">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è unit —Ç–µ—Å—Ç–æ–≤ –ø–æ –≤—Å–µ–º –º–æ–¥—É–ª—è–º –ø—Ä–æ–µ–∫—Ç–∞</p>
                  </div>
                  
                  <div class="report-card">
                      <h2>üîó</h2>
                      <a href="./integration/" class="report-link">Integration Test Report</a>
                      <p class="report-desc">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</p>
                  </div>
                  
                  <div class="report-card">
                      <h2>üîç</h2> 
                      <a href="./lint/" class="report-link">Lint Report</a>
                      <p class="report-desc">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é golangci-lint</p>
                  </div>
              </div>
              
              <div style="text-align: center; margin-top: 40px; color: #656d76;">
                  <p>üöÄ Generated by MSA Rocket Factory CI/CD Pipeline</p>
              </div>
          </body>
          </html>
          EOF

      # Update coverage badge
      - name: Update coverage Badge
        if: github.ref == 'refs/heads/main'
        uses: tj-actions/coverage-badge-go@v2
        with:
          filename: cover.out
          green: 80
          yellow: 40
          target: README.md

      - name: Verify Changed files
        if: github.ref == 'refs/heads/main'
        uses: tj-actions/verify-changed-files@v12
        id: verify-changed-files
        with:
          files: README.md

      - name: Commit changes
        if: github.ref == 'refs/heads/main' && steps.verify-changed-files.outputs.files_changed == 'true'
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add README.md
          git commit -m "chore: Updated coverage badge."

      - name: Push changes
        if: github.ref == 'refs/heads/main' && steps.verify-changed-files.outputs.files_changed == 'true'
        run: |
          git push origin HEAD:${{ github.ref_name }}

      # Pages setup and deployment
      - name: Setup Pages
        uses: actions/configure-pages@v5
        with:
          enablement: true

      - name: Upload Artifact for Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: .github_pages/

      - name: Upload Combined Report as Artifact
        uses: actions/upload-artifact@v4
        with:
          name: combined-reports
          path: |
            .github_pages/
            coverage.out
            cover.out
            lint_output.txt
            test_output.txt
            integration_output.txt
          retention-days: 30

      # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å CI
      - name: üîç Check CI Status
        run: |
          echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ CI..."
          
          LINT_STATUS="${{ steps.lint_step.outputs.LINT_STATUS }}"
          TEST_STATUS="${{ steps.test_step.outputs.TEST_STATUS }}"
          INTEGRATION_STATUS="${{ steps.integration_test_step.outputs.INTEGRATION_STATUS }}"
          
          echo "üîç –°—Ç–∞—Ç—É—Å –ª–∏–Ω—Ç–∏–Ω–≥–∞: $LINT_STATUS"
          echo "üß™ –°—Ç–∞—Ç—É—Å unit —Ç–µ—Å—Ç–æ–≤: $TEST_STATUS"
          echo "üîó –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: $INTEGRATION_STATUS"
          
          # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å
          if [[ "$LINT_STATUS" == "failure" ]] || [[ "$TEST_STATUS" == "failure" ]] || [[ "$INTEGRATION_STATUS" == "failure" ]]; then
            echo "‚ùå CI –ø—Ä–æ–≤–∞–ª–µ–Ω –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫ –≤ –ª–∏–Ω—Ç–∏–Ω–≥–µ –∏–ª–∏ —Ç–µ—Å—Ç–∞—Ö"
            echo "üìä –û—Ç—á–µ—Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã"
            exit 1
          else
            echo "‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ CI –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ"
          fi

  deploy:
    needs: combined-reports  
    runs-on: ubuntu-latest
    timeout-minutes: 10

    permissions:
      contents: write
      pages: write
      id-token: write

    # –î–µ–ø–ª–æ–∏–º —Ç–æ–ª—å–∫–æ –¥–ª—è main –≤–µ—Ç–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ CI –ø—Ä–æ–≤–∞–ª–µ–Ω (–æ—Ç—á–µ—Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω—É–∂–Ω—ã)
    if: always() && github.ref == 'refs/heads/main' && github.event_name != 'pull_request'

    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: Deploy reports to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
        continue-on-error: true

      - name: Check deployment status
        if: steps.deployment.outcome == 'success'
        run: |
          echo "‚úÖ Combined reports successfully deployed to GitHub Pages"
          echo "üìä Reports available at: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"

      - name: Deployment failed notice
        if: steps.deployment.outcome == 'failure'
        run: |
          echo "‚ö†Ô∏è GitHub Pages deployment failed"
          echo "üìã Reports are available as an artifact: combined-reports" 